---
title: "Nutrition R Tutorial"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Looking at the data

```{r data summary}
data<-read.csv("../data/nutrition.csv")
head(data,20)
```

## Obesity Rate by Age

```{r experiment}
# For the question 'percent of adults aged 18 years and older who have obesity', 
# what is the age stratification vs. obesity rate
```

```{r, message=FALSE}
# dplyr library for group_by function
library(dplyr)

```

```{r obesity-data}
obesity_data <- filter(data,Question == 'Percent of adults aged 18 years and older who have obesity')
age_obesity_data<-filter(obesity_data,StratificationCategory1=="Age (years)")
agebyobesity<-summarise(group_by(age_obesity_data,Stratification1),mean=mean(Data_Value))
```

## Data Visualization of Obesity Rate by Age

```{r, message=FALSE}
# ggplot2 library for ggplot function
library(ggplot2)
ggplot(data=agebyobesity, aes(x=Stratification1,y=mean,fill=factor(Stratification1))) +
  geom_bar(position="dodge",stat="identity") + xlab("Age Group") + ylab("Obesity Rate") + scale_fill_brewer(palette="BuGn",direction=-1) + guides(fill=guide_legend(title="Age Group")) 
```

